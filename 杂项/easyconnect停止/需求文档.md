需求文档：EasyConnect 一键强力清理工具 (Python版)
1. 需求背景
EasyConnect 客户端在关闭主程序后，其守护进程（Daemon）和服务（Service）依然驻留系统后台，持续占用系统资源且可能导致网络环境异常（如虚拟网卡残留导致无法上网）。

2. 功能目标
开发一个基于 Python 的脚本/工具，实现对 EasyConnect 及其所属“深信服（Sangfor）”组件的静默、彻底、安全的清理。

3. 详细功能模块
3.1 权限获取模块
需求：由于停止系统服务需要高权限，程序启动时需检测是否具有管理员权限。

逻辑：若无权限，需自动触发 UAC（用户账户控制）弹窗请求管理员权限。

3.2 服务停止模块 (Service Manager)
目标服务清单：

Sangfor Promotion Service

Sangfor TCP Proxy Service

Sangfor Auto-Updater

要求：使用 subprocess 调用系统指令，或使用 psutil 库进行操作。需处理服务本身已停止或不存在时的异常，不报错。

3.3 进程强杀模块 (Process Killer)
目标进程清单：

EasyConnect.exe, ECAgent.exe, SangforPromoteService.exe, SangforProxyService.exe, SangforDaemon.exe, SangforUpdateServer.exe

逻辑：

遍历当前系统进程树。

匹配上述关键字，强制结束（Equivalent to taskkill /f）。

优化：记录杀掉的进程数量并反馈。

3.4 网络适配器重置模块 (Network Reset)
需求：防止 VPN 虚拟网卡死锁导致物理机断网。

逻辑：定位名为 EasyConnect Virtual Adapter 的网卡，执行 禁用 -> 启用 操作。

4. 技术栈建议
核心库：psutil（用于跨平台进程/服务管理，比直接调 CMD 更优雅）。

系统交互：subprocess, os, admin (用于权限提升)。

打包工具：PyInstaller（最后封装成单文件 .exe，方便使用）。



6. 异常处理与边界
不存在处理：若系统中未安装 EasyConnect，应提示“未检测到相关组件”，不执行后续操作。

占用处理：若某个 .exe 无法强杀，需捕获异常并记录原因。