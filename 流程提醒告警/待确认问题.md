1. 关于人员排除逻辑（如何识别领导）

需求明确提到“**部门领导和公司领导不发送提醒**”。

• **需要确认的问题：**

  ◦ 在我们的 `sys_rbac_user`（用户表）或相关权限表中，有没有**特定的字段**（如 `JOB_TITLE` 或 `USER_LEVEL`）可以区分谁是“领导”？

  ◦ 是否有专门的“领导角色ID”？还是说需要维护一份**排除名单**？

  ◦ 如果是通过机构树判断，那么“部门负责人”这一层级在数据库中是如何定义的？



组织机构管理，需要确认。即使当时是领导处理，也不发

2.当前是领导节点 ，是整个流程不提醒 还是 只领导不提醒



2. 关于“合瑞”产品的判断逻辑

需求定义“合瑞”产品为：**产品形态为封闭式**，且**产品名称中带“合瑞”**。

• **需要确认的问题：**


  ◦ **名称模糊匹配**：名称带“合瑞”是包含关系即可，还是有特定的前缀要求？

  ◦ **触发时点**：成立日 9:00 发送一次。如果产品是在当天 9:00 之后才在系统中标记为“成立”，当天的批处理还能补发吗？

认为不存在这种数据



3. 关于角色矩阵的取数逻辑

需求中提到要发给“流程发起人”、“当前待办人”、“投资经理”、“销售经理”及“产品管理岗”等。

• **需要确认的问题：**

  ◦ **人员字段映射**：业务表（如 `ods_prdyz_base_info`）中是否已经存有这些角色的用户账号（Account）？

  ◦ **产品管理岗全员**：需求说某些节点要发给“产品管理岗全部用户”。这是否意味着我需要关联角色权限表，查出所有拥有该角色 ID 的 `account`？

产品管理岗需要确认  

4. 关于时间与日历判断

需求要求在“**银行间日历所有工作日**”执行。

• **需要确认的问题：**

  ◦ **日历表选择**：你提供的 SQL 示例使用了 `dw_dt_date` 表且 `DT_TYPE = 'A'`。请确认 `DT_TYPE = 'A'` 是否就是标准的“银行间工作日”？

产品自己的日历类型  银行间和交易所



select * from sys_common_wechat_log scwl

日志记录表







5. 关于发送细节与自测

• **需要确认的问题：**

  ◦ **发起部门取值**：需求提到申报登记取“报备审批流程”的发起部门，发行登记取“发行审批流程”的发起部门。我需要知道这些流程之间是如何通过 **ID 关联**的（例如：有没有关联的外键字段）？

  ◦ **自测环境**：企业微信消息推送是否有**测试模式**？我能否在自测阶段将所有消息重定向发送给我自己，或者发送到一个特定的企业微信测试群，以免打扰到真实业务人员？

  ◦ **补发逻辑**：如果某次 9:00 的批处理执行失败了，11:00 执行时是否需要把 9:00 该发未发的补上？

6. 关于 SQL 出参的最终核实

你之前的示例只包含 `account`、`CONTENT`、`OPERATOR`、`OPERATOR_ACCOUNT` 和 `TRIGGER`。

• **需要确认的问题：**

  ◦ 是否确认**不需要**在 SQL 出参中包含 `PRD_CODE`（产品代码）或 `INSTANCE_ID`（流程实例ID）供下游日志记录？

  ◦ `CONTENT`（消息正文）的长度限制是多少？如果产品名称很长，是否需要截断？

**总结建议：** 你下午确认的重点应该是**“如何通过具体的数据库字段来实现需求中的文字描述”**（例如：‘领导’=什么字段，‘封闭式’=什么代码），这样你写 SQL 时才有依据。